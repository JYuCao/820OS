---
title: 磁盘存储器的管理
markmap:
  colorFreezeLevel: 3
---

# 磁盘存储器的管理
## 外存的组织方式
### 连续组织方式
- 优点
    - 顺序访问容易
    - 顺序访问速度快
- 缺点
    - 要求为一个文件分配连续的存储空间
    - 必须事先知道文件长度
    - 不能灵活地删除和插入记录
    - 对于那些动态增长的文件很难分配空间

### 链接组织方式
- 优点
    - 消除了磁盘的外部碎片，提高了外村利用率
    - 对插入、删除和修改记录都非常容易
    - 能适应文件的动态增长，无需事先知道文件大小
- 缺点
    - 存取大文件要顺序查找多个盘块号
    - 只有将整个FAT调入内存才能保证查找到完整的文件盘块号

- 隐式链接与显式链接
- 簇（Cluster）

- 文件分配表FAT
    - 卷（分区）
    - FAT12、FAT16、FAT32
- NTFS(New Technology File System)
    - 逻辑簇号LCN、虚拟簇号VCN
    - 主控文件表MFT

### 索引组织方式
#### 单级索引组织方式

#### 多级索引组织方式

#### 增量式索引组织方式
- 直接地址、一次间址、多次间址

## 文件存储空间的管理
### 空闲表
- 连续分配方式，类似于内存的动态分配方式

### 空闲链表
- 空闲盘块链和空闲盘区链

### 位示图
- 盘块的分配与回收计算

### 成组链接
- 空闲盘块的组织、分配和回收

## 提高磁盘I/O速度的途径
### 磁盘高速缓存(Disk Cache)
- 数据交付方式：数据交付、指针交付
- 置换算法：除最近最久未使用外，考虑访问频率、可预见性、数据一致性
- 周期性写回磁盘

### 其他方法
- 提前读、延迟写、优化物理块的分布、虚拟盘

### 廉价磁盘冗余阵列(RAID)
- 并行交叉存取
- RAID分级
    - RAID0：仅提供并行交叉存取
    - RAID1：具有磁盘镜像，仅有一半的磁盘容量被用作存储
    - RAID3：具有并行传输功能，只利用一台奇偶校验盘
    - RAID5：具有独立传送功能，校验信息以螺旋方式散布在所有数据盘中
    - RAID6和7：有一个专用的可快速访问的异步校验盘
- 优点：可靠性高、磁盘I/O速度高、性价比高

## 提高磁盘可靠性的技术
### 第一级容错技术SFT-I
- 双份目录和双份文件分配表
- 热修复重定向和写后读校验

### 第二级容错技术SFT-II
- 磁盘镜像(Disk Mirroring)、磁盘双工(Disk Duplexing)

### 基于集群技术的容错功能
- 双机热备份模式
- 双机互为备份模式
- 公用磁盘模式

### 后备系统
- 磁带机、硬盘、光盘驱动器

## 数据一致性控制
### 事务
- 托付(Commit)、夭折/回滚/取消(Abort)
- 原子性、一致性、隔离性、持久性(ACID)
- 事务记录(Transaction Record)
- 恢复算法：redo undo

### 检查点

### 并发控制
- 利用互斥锁(Exclusive Lock)实现顺序性
- 利用互斥和共享锁(Shared Lock)实现顺序性

### 重复数据的数据一致性问题
- 重复文件的一致性
- 链接数一致性检查
