---
title: 文件管理
markmap:
  colorFreezeLevel: 3
---
# 文件管理
## 文件系统
### 几个概念
- 数据项：基本数据项和组合数据项
- 记录：关键字(Key)
- 文件：文件类型、长度、物理位置、建立时间

### 文件名和类型
- 文件名和扩展名
- 文件类型
    - 用途：系统、用户、库文件
    - 数据形式：源文件、目标文件、可执行文件
    - 存取控制：只执行、只读、读写
    - 组织形式和处理方式：普通、目录、特殊文件

### 文件系统的层次结构
- 对象和属性（最底层）：文件、目录、磁盘存储空间
- 对对象操纵和管理的软件集合
    - 功能：对文件存储空间的管理；对文件目录的管理；将文件的逻辑
    地址转换成物理地址；对文件读写的管理；对文件的共享与保护等
    - 分层：I/O控制层、基本文件系统层、基本I/O管理程序、逻辑文件系统
- 文件系统的接口：命令接口、程序接口

### 文件操作
- 最基本的文件操作：创建、删除、读、写、设置文件读写位置
- 打开与关闭
- 其他文件操作：对文件属性的操作、有关目录的操作等

## 文件的逻辑结构
### 类型
#### 按文件是否有结构分类
- 有结构文件：定长记录、变长记录
- 无结构文件（流式文件）

#### 按文件的组织方式分类
- 顺序文件、索引文件、索引顺序文件

### 顺序文件
- 排列方式：串结构、顺序结构
- 优点：便于批量存取和顺序存取设备
- 缺点：查找和修改单个记录耗时长，增删记录开销大

### 记录寻址
- 隐式寻址方式：Wptr+L
- 显式寻址方式：通过记录位置和通过关键字

### 索引文件
#### 按关键字建立索引与多重索引表

#### 索引顺序文件
- 特征
  - 引入了文件索引表，可实现对索引顺序文件的随机访问
  - 增加了溢出文件，记录新增加删除和修改的记录

- 一级索引顺序文件
- 两级索引顺序文件

#### 直接文件和哈希文件

## 文件目录
### 目录管理的要求
- 实现按名存取
- 提高对目录的检索速度
- 文件共享
- 允许文件重命名

### 文件控制块FCB
- 基本信息类：文件名、文件物理位置、文件逻辑结构、文件物理结构
- 存取控制信息类
- 使用信息类

### 索引节点
- 磁盘索引节点、内存索引节点

### 单级文件目录
- 实现按名存取
- 查找速度慢、不允许重名、不便于实现文件共享

### 两级文件目录
- 用户文件目录（UFD, User File Directory）、主文件目录（MFD）
- 优点：提高检索速度、不同用户目录可用相同的命名、可用不同名共享同一文件
- 缺点：不便于用户访问其他用户的文件

### 树形目录结构
- 路径名和当前目录
- 目录操作：增、删、改、移动、链接、查找

### 目录查询
- 线性索引法、Hash方法

## 文件共享
### 有向无循环图DAG(Directed Acyclic Graph)
- 一个文件或子目录可以拥有多个父目录（指针）

### 索引节点
- 共享时指向索引节点

### 符号链接(Symbolic Linking)
- 一个文件或子目录可以拥有多个父目录，但分主与链接（路径名）

## 文件保护
### 保护域与访问权(Access Right)
- 进程和域间的静态联系：一个进程联系一个域
- 进程和域间的动态联系：一个进程联系多个域

### 访问矩阵(Access Matrix)
- 行代表域，列代表对象
- 具有域切换权的访问矩阵
- 访问矩阵的修改：拷贝权、拥有权、控制权
- 实现
  - 访问控制表ACL：按列（对象）划分
  - 访问权限表：按行（域）划分

