---
title: 进程的描述与控制
markmap:
  colorFreezeLevel: 3
---

# 进程的描述与控制
## 进程
### 定义
- 进程是进程实体的运行过程，是系统进行资源分配的一个独立单位
- 进程实体（进程映像）：程序段、数据段和进程控制块(PCB)

### 特征
- 动态性：进程实体具有一定的生命周期
- 并发性：多个进程实体同存于内存中，且能在一段时间内同时运行
- 独立性：进程是一个能独立运行、获得资源和接收调度的基本单位
- 异步性：进程按各自独立的，不可预知的速度向前推进

### 进程的基本状态及转换
#### 三种基本状态
- 就绪(Ready)状态：进程已分配到除CPU外的所有必要资源
- 执行(Running)状态：进程已获得CPU，正在执行的状态
- 阻塞(Block)状态：进程由于发生某事件而暂时无法继续执行

#### 创建和终止
- 创建状态
- 终止状态

### 挂起操作
- 挂起操作的引入
    - 终端用户的需要
    - 父进程请求
    - 负荷调节的需要
    - 操作系统的需要

- 引入挂起原语操作后进程状态的转换
    - 挂起原语Suspend和激活原语Active
    - 活动就绪(Readya)→静止就绪(Readys)
    - 活动阻塞(Blocka)→静止阻塞(Blocks)
    - 静止就绪→活动就绪
    - 静止阻塞→活动阻塞

- 引入挂起操作后新增的状态转换
    - NULL→创建
    - 创建→活动就绪
    - 创建→静止就绪
    - 执行→终止

### 进程控制块
#### 作用
- 作为独立运行基本单位的标志
- 能实现间断运行方式
- 提供进程管理所需要的信息
- 提供进程调度所需要的信息
- 实现与其他进程的同步通信

#### 进程控制块中的信息
- 进程标识符：外部标识符和内部标识符
- 处理机状态：主要由各种寄存器组成
    - 通用寄存器
    - 指令计数器
    - 程序状态字PSW
    - 用户栈指针
- 进程调度信息
    - 进程当前状态
    - 进程优先级
    - 进程调度所需的其他信息
    - 事件：阻塞原因
- 进程控制信息
    - 程序和数据地址
    - 进程同步和通信机制：信号量和消息队列指针等
    - 资源清单：所需资源和已分配资源
    - 链接指针：下一个PCB的地址

#### 进程控制块的组织方式：线性、链接、索引

## 进程控制
### 操作系统内核
- 系统态（管态）和用户态（目态）
- 支撑功能：中断、时钟、原语(Primitive)
- 资源管理功能：进程管理、存储器管理、设备管理

### 进程的创建
#### 引起创建进程的事件
- 用户登录
- 作业调度
- 提供服务
- 应用请求

#### 创建流程
1. 申请空白PCB
2. 分配运行所需资源
3. 初始化PCB：标识信息、处理机状态和控制信息
4. 如果就绪队列能接纳新进程，将其插入就绪队列

### 进程的终止
#### 引起进程终止(Termination of Process)的事件
- 正常结束：进程任务完成
- 异常结束：异常事件导致程序无法运行。越界错、保护错、非法指令、
特权指令错、运行超时、等待超时、算术运算错、I/O故障等
- 外界干预：应外界的请求而终止。操作员或操作系统干预、
父进程请求、父进程终止

#### 终止过程
1. 根据标识符检索出该进程PCB，并读取状态；
2. 若进程正处于执行状态应立即终止，并置调度标志为真，用于指示该进程被终止后应重新进行调度；
3. 将其所有子孙进程终止，以防它们成为不可控的进程；
4. 将进程所拥有的全部资源或者归还给其父进程或系统；
5. 将被终止进程PCB从所在集合移出，等待其他程序来搜集信息。

### 进程的阻塞与唤醒
#### 引起进程阻塞和唤醒的事件
- 向系统请求共享资源失败
- 等待某种操作的完成
- 新数据尚未到达
- 等待新任务的到达

#### 进程阻塞过程
1. 进程 __主动__ 调用原语block
2. 停止执行，将PCB中的现行状态由执行改为阻塞，并将进程插入阻塞队列
3. 保留被阻塞进程的处理机状态，按新进程的PCB设置CPU现场环境

#### 进程唤醒过程
1. 有关进程调用唤醒原语wakeup
2. 把被阻塞进程从阻塞队列移出，将PCB状态由阻塞改为就绪，然后插入就绪队列

### 进程的挂起与激活
#### 进程的挂起
1. 更改进程状态为对应状态
2. 把其PCB复制到某指定内存区域
3. 若进程正在执行，则转向调度程序重新调度

#### 进程的激活过程
1. 将进程从外存调入内存，更改进程状态为对应状态
2. 由调度程序将被激活进程与当前进程的优先级进行比较，决定处理机的分配

## 进程同步
### 基本概念
- 间接相互制约关系和直接相互制约关系
- 临界资源(Critical Resource)
    - 临界区(Critical Section)：访问临界资源的那段代码
    - 进入区(Entry Section)、退出区(Exit Section)和剩余区(Remainder Section)
- 同步机制应遵循的规则
    - 空闲让进
    - 忙则等待
    - 有限等待
    - 让权等待

### 硬件同步机制
- 关中断
- Test-and-Set指令
- Swap指令